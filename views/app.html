<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>{{app_name}}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
        <meta http-equiv="cleartype" content="on">
        <meta name="description" content="" />
      	<meta name='keywords' content=''/>

        <link rel="author" href="/humans.txt">
        
        <link href="/css/main.css" rel="stylesheet">

        <meta property="og:title" content="SparkDash Mobile Analytics.">
        <meta property="og:type" content="company">
        <meta property="og:image" content="http://semanticpress.com/assets/img/logos/sparkdash.png">
        <meta property="og:site_name" content="SemanticPress.com">
        <meta property="og:url" content="http://SemanticPress.com/">
        <meta property="og:description" content="">   

        <link rel="shortcut icon" href="/favicon.ico">
        <link rel="icon" href="/img/logos/favicon.png" type="image/png">
        <link rel="apple-touch-icon" sizes="144x144" href="/img/logos/apple-touch-icon-144.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/img/logos/apple-touch-icon-114.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/img/logos/apple-touch-icon-72.png">
        <link rel="apple-touch-icon" href="/img/logos/apple-touch-icon-57.png">
    </head>

    <body controller="app">
        
        <div id="layout" class="pure-g-r">

          <div id="main" class="pure-u-1">
            <div id="main-menu-container" class="pure-g">
              <div id="main-menu-tabs" class="pure-u-1">
                <nav>
                  <ul>
                    <li action="tab.launchpad"><a href="/">LaunchPad</a></li>
                    <li class="active" action="tab.apps"><a href="/apps">Apps</a></li>
                    <li action="tab.data"><a href="/data">Data</a></li>
                  </ul>
                </nav>
              </div>
              <div class="pure-u-1" style="text-align:center;padding:4px;font-size:18px;opacity:0.9;color:#fff;width:200px;margin:auto;">{{#domain}}{{title}}{{/domain}}</div>
              <div id="main-menu-login" class="pure-u-1">
                <nav>
                  <ul>
                    <li class="active" action="user.logout">sign out</li>
                  </ul>
                </nav>
              </div>
            </div>

            <div id="main-container" class="pure-g-r">
              
              <div class="content">
                
                {{#app}}
                
                  <div class="pure-u-1-1" style="clear:both;">
                    <div class="l-box" style="border:1px solid #999;border-radius:5px;margin-top:10px;background-color:#FFF;padding:10px;letter-spacing:0px;">
                      <h2 style="text-align:center;">{{title}}</h2>
                      <div style="text-align:center;margin-top:-10px;margin-bottom:20px;">{{pkg}}</div>
                      
                      <div style="margin-bottom:20px;">
                        <div class="pure-menu pure-menu-open pure-menu-horizontal">
                            <ul>
                                <li class="pure-menu-selected"><a href="#">Sessions</a></li>
                                <li class="pure-menu-disabled"><a href="#">Installs</a></li>
                            </ul>
                        </div>
                        
                        <div style="border:1px solid #efefef;height:250px;">
                          <img id="ccw_chart" src="https://encrypted.google.com/finance/chart?espv=210&amp;es_sm=119&amp;q=CURRENCY:CNYUSD&amp;tkr=1&amp;p=5Y&amp;chst=vkc&amp;chs=400x130&amp;chsc=1" data-src="https://encrypted.google.com/finance/chart?espv=210&amp;es_sm=119&amp;q=CURRENCY:CNYUSD&amp;tkr=1&amp;p=5Y&amp;chst=vkc" style="width:100%" class="chart_height" alt="">
                        </div>
                      </div>
                      <form class="pure-form">
                        <fieldset id="version" style="padding:10px;">
                            <legend>App Version</legend>
                            <p>
                              
                              {{#ifCond current_build.length '>' 0}}
                              <label id="current_build" style="color:#333;padding:10px;background-color:#ffffaa;"> Current Build: <i style="color:#ff0000;">{{current_build}}</i></label>
                              {{else}}
                              <label id="current_build" style="color:#333;padding:10px;background-color:#ffffaa;" data-tip="You need to add a build number to enable auto updating.">Current Build: <i style="color:#ff0000;">None</i></label>
                              {{/ifCond}}
                              
                              <button id="forceUpdateButton" class="pure-button pure-button-xlarge pure-button-disabled" action="runForceUpdate" data-tip="This will force devices to automatically update to this version." style="opacity:0.1;" disabled="true">Force Update</button>
                              
                              <button class="pure-button pure-button-xsmall pure-button-success" action="addNewAppBuild" style="float:right;margin-right:10px;">New</button>
                            </p>
                            
                            <table id="versionTable" class="pure-table pure-table-horizontal" style="width:100%;max-width: 800px;">
                                <thead>
                                    <tr>
                                        <th style="width:80px;">Build</th>
                                        <th style="width:600px;">URL</th>
                                        <th style="width:75px;"></th>
                                        <th style="width:100px;"></th>
                                        <th style="width:30px;"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    
                                    {{#ifCond builds 'not exists' 0}}
                                      <tr class="empty" style="height:100px;">
                                        <td colspan="5" style="vertical-align: middle;text-align:center;">
                                          <h1>App data model is missing builds array</h1>
                                        </td>
                                      </tr>
                                    {{else}}
                                    
                                      {{#ifCond builds.length '==' 0}}
                                      <tr class="empty" style="height:100px;">
                                        <td colspan="5" style="vertical-align: middle;text-align:center;">
                                          <button class="pure-button pure-button-success" action="addNewAppBuild" style="text-align:center;">Add Build</button>
                                        </td>
                                      </tr>
                                      {{else}}

                                        {{#builds}}
                                          <tr id="{{build}}" data="{{json this}}">
                                            <td>{{build}}</td>
                                            <td>{{url}}</td>
                                            <td class="edit"><button class="pure-button pure-button-xsmall" action="editAppBuild">Edit</button></td>
                                            <td class="activate"><button class="pure-button pure-button-xsmall pure-button-primary" action="setAppBuild">Set Active</button></td><td><button class="pure-button pure-button-xsmall pure-button-error" action="deleteAppBuild">X</button></td>
                                          </tr>
                                        {{/builds}}

                                      {{/ifCond}}
                                      
                                    {{/ifCond}}
                                    
                                    
                                    
                                </tbody>
                            </table>
                            
                        </fieldset>
                      </form>
                     
                      <fieldset id="logs" style="padding:10px;">
                          <legend>Real-Time Logs</legend>
                          <div id="terminal-header">Initializing...</div>
                          <div id="terminal" style="max-width: 688px;height:300px;background-color:#000;"></div>
                      </fieldset>
                                            
                    </div>
                  </div>
                
                {{/app}}  
              </div>
              
              </div>
              
            </div>
          </div>
        </div>
        
        <div id="modals"></div>
        
        <script>
        var DOMAIN = '{{#domain}}{{id}}{{/domain}}';
        var PKG = '{{#app}}{{pkg}}{{/app}}';
        var ID = '{{#app}}{{_id}}{{/app}}';
        </script>
        <script src="http://js.pusher.com/2.1/pusher.min.js" type="text/javascript"></script>
        <script data-main="/js/app.min" src="/js/require.js"></script>
    </body>
</html>
